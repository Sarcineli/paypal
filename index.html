<!DOCTYPE html>
<html>
<head>
  <title>Shopping Cart</title>
  <style>
    /* Add some basic styling for clarity */
    label {
      display: block;
      margin-bottom: 10px;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <h1>Shopping Cart</h1>
  
  <h2>Product Details</h2>
  <p>
    <strong>Product Name:</strong> Sample Product<br>
    <strong>Item Number:</strong> 123456789<br>
    <strong>Price:</strong> $19.99
  </p>
  
  <h2>Buyer Information</h2>
  <form id="buyerForm" action="/processOrder" method="POST">
    <label for="firstName">First Name:</label>
    <input type="text" id="firstName" name="firstName" value="John" required>
    
    <label for="lastName">Last Name:</label>
    <input type="text" id="lastName" name="lastName" value="Doe" required>
    
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" value="johndoe@example.com" required>
    
    <label for="phone">Phone Number:</label>
    <input type="tel" id="phone" name="phone" value="1234567890" required>
    
    <label for="address">Shipping Address:</label>
    <input type="text" id="address" name="address" value="123 Main St" required>
    
    <label for="country">Country:</label>
    <input type="text" id="country" name="country" value="United States" required>
    
    <label for="state">State:</label>
    <input type="text" id="state" name="state" value="California" required>
    
    <label for="zip">Zip:</label>
    <input type="text" id="zip" name="zip" value="12345" required>
    
    <div id="paypal-button-container"></div>
  </form>

  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID"></script>
  <script>
    // Client-side validation and additional functionality
    document.getElementById("buyerForm").addEventListener("submit", function(event) {
      // Prevent form submission if validation fails
      if (!validateForm()) {
        event.preventDefault();
      }
    });

    function validateForm() {
      // ... código de validação do formulário ...

      return isValid;
    }

    function displayError(fieldId, message) {
      // ... função para exibir erros ...

      // Append the error message after the input field
      field.parentNode.appendChild(errorElement);
    }

    function removeError(fieldId) {
      // ... função para remover erros ...
    }

    // Render the PayPal button
    paypal.Buttons({
      createOrder: function(data, actions) {
        // Set up the transaction
        return actions.order.create({
          purchase_units: [{
            amount: {
              value: '19.99'
            }
          }]
        });
      },
      onApprove: function(data, actions) {
        // Capture the funds from the transaction
        return actions.order.capture().then(function(details) {
          // Prepare the order details to send to the server
          const orderDetails = {
            firstName: document.getElementById('firstName').value,
            lastName: document.getElementById('lastName').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            address: document.getElementById('address').value,
            country: document.getElementById('country').value,
            state: document.getElementById('state').value,
            zip: document.getElementById('zip').value,
            transactionId: details.id
          };

          // Send the order details to the server
          sendOrderToServer(orderDetails);

          // Redirect or display a success message to the buyer
          alert('Order placed successfully!');
        });
      }
    }).render('#paypal-button-container');

    function sendOrderToServer(orderDetails) {
      // Make an AJAX request to send the order details to the server
      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'http://127.0.0.1:5500/', true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onreadystatechange = function() {
        if (xhr.readyState === XMLHttpRequest.DONE) {
          if (xhr.status === 200) {
            // Success response from the server
            console.log('Order processed successfully');
          } else {
            // Error response from the server
            console.error('Failed to process the order');
          }
        }
      };
      xhr.send(JSON.stringify(orderDetails));
    }
  </script>
  <script src="https://www.paypal.com/sdk/js?client-id=AUkIqX8u1rHLj_FY2MlcmnweRbZu8qB3w9baeflUTDUWrPTh47PIx2nqHiJ-bfiQMaxNE6vBrZMdgyGB" data-client-token="abc123xyz=="></script>
</body>
</html>
